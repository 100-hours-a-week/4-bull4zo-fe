#!/bin/sh

pnpm lint-staged

BRANCH=$(git symbolic-ref --short HEAD)

if echo "$BRANCH" | grep -Eq '^(feature|refactor|chore|bugfix|hotfix|release|cicd)/|^develop$|^main$'; then
  echo "âœ… ë¸Œëœì¹˜ ì´ë¦„ ê²€ì¦ í†µê³¼: $BRANCH"
else
  echo "âŒ ì˜ëª»ëœ ë¸Œëœì¹˜ ì´ë¦„ì…ë‹ˆë‹¤: '$BRANCH'"
  echo "â„¹ï¸ ë¸Œëœì¹˜ëŠ” 'feature/', 'refactor/', 'chore/', 'bugfix/', 'hotfix/', 'release/', 'cicd/', 'develop', 'main' ì¤‘ í•˜ë‚˜ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤."
  exit 1
fi


if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "develop" ]; then
  echo "ğŸ›  ë¹Œë“œ ê²€ì‚¬ ì‹œì‘..."
  pnpm build
  if [ $? -ne 0 ]; then
    echo "âŒ ë¹Œë“œ ì‹¤íŒ¨! ì»¤ë°‹ ì°¨ë‹¨"
    exit 1
  fi
  echo "âœ… ë¹Œë“œ ì„±ê³µ"
else
  echo "â„¹ï¸ í˜„ì¬ ë¸Œëœì¹˜($BRANCH)ì—ì„œëŠ” ë¹Œë“œ ê²€ì‚¬ ìƒëµ"
fi
